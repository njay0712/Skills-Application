<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sozo Skills Application</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; padding: 20px; }
        .container { max-width: 800px; margin: 0 auto; background: white; border-radius: 15px; box-shadow: 0 10px 40px rgba(0,0,0,0.2); overflow: hidden; }
        .header { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 30px; text-align: center; }
        .header h1 { font-size: 2.2em; margin-bottom: 10px; }
        .form-section { padding: 40px; display: none; /* Hidden by default, JS handles visibility */ }
        .form-section.active { display: block; animation: fadeIn 0.5s; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        
        /* Form Elements */
        .form-group { margin-bottom: 25px; }
        label { display: block; margin-bottom: 8px; color: #333; font-weight: 600; }
        input, select, textarea { width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-size: 1em; transition: border-color 0.3s; }
        input:focus, select:focus, textarea:focus { outline: none; border-color: #667eea; }
        .required { color: #e74c3c; }
        
        /* Buttons */
        .btn-submit, .btn-next { width: 100%; padding: 15px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; border-radius: 8px; font-size: 1.2em; font-weight: 600; cursor: pointer; transition: transform 0.3s; margin-top: 10px; }
        .btn-submit:hover, .btn-next:hover { transform: translateY(-2px); }
        .btn-submit:disabled { background: #ccc; cursor: not-allowed; }
        
        /* Specific Styles */
        .id-type-selection { display: flex; gap: 20px; margin-bottom: 15px; }
        .id-type-selection label { display: inline-flex; align-items: center; font-weight: 400; }
        .id-type-selection input[type="radio"] { width: auto; margin-right: 8px; }
        .conditional-section { border: 1px dashed #667eea; padding: 15px; border-radius: 8px; margin-top: 10px; }
        .permit-info { border-left: 3px solid #f39c12; padding-left: 10px; margin-top: 15px; }
        .program-info-box { display: none; border: 1px solid #ddd; border-radius: 8px; padding: 20px; margin-top: 20px; background-color: #f9f9f9; box-shadow: 0 2px 4px rgba(0,0,0,0.05); }
        .program-info-box img { width: min(100%, 250px); height: auto; border-radius: 6px; margin-bottom: 15px; display: block; margin-left: auto; margin-right: auto; }
        .loading { text-align: center; padding: 20px; color: #667eea; display: none; }
        
        /* Assessment Styles */
        .rating-group { display: flex; justify-content: space-between; align-items: center; margin-top: 10px; padding: 5px 0; border-top: 1px dashed #eee; }
        .rating-group label { font-weight: 400; font-size: 1em; margin-bottom: 0; }
        .rating-group select { width: 150px; }

        /* Thank You Styles */
        .success-icon { font-size: 80px; margin-bottom: 20px; display: block; text-align: center; }
        .info-item { display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px dotted #eee; text-align: left; }
        .info-label { font-weight: 600; color: #333; }
        .info-value { color: #667eea; font-weight: 500; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1 id="pageTitle">ðŸŽ“ Application Form</h1>
            <p id="pageSubtitle">Step 1: Personal Information</p>
        </div>

        <div id="section-application" class="form-section active">
            <form id="appForm">
                <h2 style="color: #667eea; margin-bottom: 20px;">Personal Information</h2>
                <div class="form-group"><label>First Name <span class="required">*</span></label><input type="text" name="firstName" required></div>
                <div class="form-group"><label>Last Name <span class="required">*</span></label><input type="text" name="lastName" required></div>
                <div class="form-group"><label>Identification Type <span class="required">*</span></label><div class="id-type-selection"><label><input type="radio" name="identificationType" value="SA ID" required onclick="toggleIdentificationType(this)">South African ID</label><label><input type="radio" name="identificationType" value="Passport" required onclick="toggleIdentificationType(this)">Passport / Foreign ID</label></div></div>
                <div class="form-group conditional-section" id="saIdGroup" style="display: none;"><label>South African ID Number <span class="required">*</span></label><input type="text" name="idNumber" id="idNumberInput" pattern="[0-9]{13}" placeholder="13-digit ID number" oninput="processSAID(this)"></div>
                <div class="form-group conditional-section" id="passportGroup" style="display: none;"><label>Passport Number <span class="required">*</span></label><input type="text" name="passportNumber" id="passportNumberInput"><div class="permit-info"><div class="form-group" style="margin-top: 15px;"><label style="font-weight: 700;">Do you have a valid Work or Study Permit? <span class="required">*</span></label><select name="permitStatus" id="permitStatusInput" onchange="togglePermitDetails(this)"><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option></select></div><div class="form-group" id="permitDetailsGroup" style="display: none;"><label>Permit Details (e.g., Permit Type, Expiry Date)</label><input type="text" name="permitDetails"></div></div></div>
                <div class="form-group"><label>Date of Birth <span class="required">*</span></label><input type="date" name="dateOfBirth" id="dateOfBirthInput" required readonly style="background-color: #eee;"></div>
                <div class="form-group"><label>Age <span class="required">*</span></label><input type="number" name="age" id="ageInput" required min="16" max="65" readonly style="background-color: #eee;"></div>
                <div class="form-group"><label>Gender <span class="required">*</span></label><select name="gender" required onchange="toggleConstructionExperience(this)"><option value="">Select Gender</option><option value="Male">Male</option><option value="Female">Female</option><option value="Other">Other</option></select></div>
                <div class="form-group conditional-section" id="constructionExperienceSection" style="display: none;"><label>Do you have any experience in construction or related trades?</label><select name="constructionExperience" onchange="toggleConstructionDetails(this)"><option value="No">No</option><option value="Yes">Yes</option></select><div class="form-group" id="constructionDetailsGroup" style="display: none; margin-top: 15px;"><label>Please briefly describe your experience</label><textarea name="constructionDetails" rows="2"></textarea></div></div>
                <div class="form-group"><label>Race <span class="required">*</span></label><select name="race" required><option value="">Select Race</option><option value="African">African</option><option value="Coloured">Coloured</option><option value="Indian">Indian</option><option value="White">White</option><option value="Other">Other</option></select></div>
                <div class="form-group"><label>Do you have a disability? <span class="required">*</span></label><select name="disability" required onchange="toggleDisabilityType(this)"><option value="">Select</option><option value="No">No</option><option value="Yes">Yes</option></select></div>
                <div class="form-group" id="disabilityTypeGroup" style="display: none;"><label>Type of Disability</label><input type="text" name="disabilityType"></div>
                <h2 style="color: #667eea; margin: 30px 0 20px;">Contact Information</h2>
                <div class="form-group"><label>Mobile Number <span class="required">*</span></label><input type="tel" name="mobile" required pattern="[0-9]{10}"></div>
                <div class="form-group"><label>Alternative Mobile Number</label><input type="tel" name="altMobile" pattern="[0-9]{10}"></div>
                <div class="form-group"><label>Email Address</label><input type="email" name="email"></div>
                <div class="form-group"><label>Area <span class="required">*</span></label><select name="area" required><option value="">Select Area</option><option value="Vrygrond">Vrygrond</option><option value="Muizenberg">Muizenberg</option><option value="Lakeside">Steenberg</option><option value="Ocean View">Lavender Hill</option><option value="Fish Hoek">Grassy Park</option><option value="Ocean View">Cadfa</option><option value="Fish Hoek">Retreat</option><option value="Ocean View">Seawinds</option><option value="Fish Hoek">Hillview</option></select></div>
                <div class="form-group"><label>Full Address <span class="required">*</span></label><textarea name="address" rows="3" required></textarea></div>
                <h2 style="color: #667eea; margin: 30px 0 20px;">Educational & Employment</h2>
                <div class="form-group"><label>Highest Education Level <span class="required">*</span></label><select name="education" required><option value="">Select</option><option value="Primary School">Primary School</option><option value="Grade 9">Grade 9</option><option value="Grade 10">Grade 10</option><option value="Grade 11">Grade 11</option><option value="Matric">Matric</option><option value="Tertiary">Tertiary</option></select></div>
                <div class="form-group"><label>Current Employment Status <span class="required">*</span></label><select name="employmentStatus" required><option value="">Select</option><option value="Unemployed">Unemployed</option><option value="Employed - Full Time">Employed - Full Time</option><option value="Employed - Part Time">Employed - Part Time</option><option value="Self-Employed">Self-Employed</option><option value="Student">Student</option></select></div>
                <div class="form-group"><label>Monthly Household Income (R) <span class="required">*</span></label><select name="income" required><option value="">Select Income Bracket</option><option value="0-R1000">R0 - R1,000</option><option value="R1001-R3000">R1,001 - R3,000</option><option value="R3001-R5000">R3,001 - R5,000</option><option value="R5001+">R5,001+</option></select></div>
                <h2 style="color: #667eea; margin: 30px 0 20px;">Program Selection</h2>
                <div class="form-group"><label>Which program are you applying for? <span class="required">*</span></label><select name="program" required onchange="displayProgramInfo(this)"><option value="">Select Program</option><option value="Artisan Baking">Artisan Baking</option><option value="Barista">Barista</option><option value="Hair">Hair</option><option value="Beauty">Beauty</option></select></div>
                <div class="program-info-box" id="programInfoBox"></div>
                
                <button type="button" class="btn-next" onclick="goToAssessment()">Next: Start Assessment â†’</button>
            </form>
        </div>

        <div id="section-assessment" class="form-section">
            <form id="assessmentForm">
                <h2 style="color: #667eea; margin-bottom: 20px;">Skills & Experience</h2>
                <div class="form-group"><label>Technical learning ability (1-5) <span class="required">*</span></label><select name="technicalKnowledge" required><option value="">Select</option><option value="1">1 - Very Low</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5 - Excellent</option></select></div>
                <div class="form-group"><label>Experience with relevant tools <span class="required">*</span></label><textarea name="toolsExperience" rows="3" required></textarea></div>
                <div class="form-group"><label>Other existing skills <span class="required">*</span></label><textarea name="existingSkills" rows="3" required></textarea></div>
                
                <h2 style="color: #667eea; margin: 30px 0 20px;">Soft Skills (1-5)</h2>
                <div class="form-group">
                    <label>Self-Assessment:</label>
                    <div class="rating-group"><label>Following instructions</label><select name="followInstructions" required><option value="">Select</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option></select></div>
                    <div class="rating-group"><label>Time management</label><select name="timeManagement" required><option value="">Select</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option></select></div>
                    <div class="rating-group"><label>Teamwork</label><select name="teamwork" required><option value="">Select</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option></select></div>
                    <div class="rating-group"><label>Customer communication</label><select name="customerCommunication" required><option value="">Select</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option></select></div>
                    <div class="rating-group"><label>Asking for help</label><select name="askingHelp" required><option value="">Select</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option></select></div>
                </div>

                <div class="form-group"><label>Languages spoken</label><textarea name="languages" rows="2"></textarea></div>
                
                <h2 style="color: #667eea; margin: 30px 0 20px;">Digital & Motivation</h2>
                <div class="form-group"><label>Own a smartphone? <span class="required">*</span></label><select name="smartphone" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option></select></div>
                <div class="form-group"><label>Social media comfort (1-5) <span class="required">*</span></label><select name="socialMedia" required><option value="">Select</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option></select></div>
                <div class="form-group"><label>Computer use frequency <span class="required">*</span></label><select name="computerUse" required><option value="">Select</option><option value="Never">Never</option><option value="Rarely">Rarely</option><option value="Weekly">Weekly</option><option value="Daily">Daily</option></select></div>
                <div class="form-group"><label>Employment importance (1-5) <span class="required">*</span></label><select name="employmentImportance" required><option value="">Select</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option></select></div>
                <div class="form-group"><label>Interest in starting business? <span class="required">*</span></label><select name="businessInterest" required><option value="">Select</option><option value="Yes">Yes</option><option value="Maybe">Maybe</option><option value="No">No</option></select></div>
                <div class="form-group"><label>Commitment to complete program (1-5) <span class="required">*</span></label><select name="commitment" required><option value="">Select</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option></select></div>
                
                <div class="form-group"><label>Main goals after training <span class="required">*</span></label><textarea name="goals" rows="3" required></textarea></div>
                <div class="form-group"><label>Anticipated challenges <span class="required">*</span></label><textarea name="challenges" rows="3" required></textarea></div>
                <div class="form-group"><label>Support needed <span class="required">*</span></label><textarea name="supportNeeds" rows="3" required></textarea></div>
                <div class="form-group"><label>Family support level <span class="required">*</span></label><select name="familySupport" required><option value="">Select</option><option value="Fully Supportive">Fully Supportive</option><option value="Mostly Supportive">Mostly Supportive</option><option value="Neutral">Neutral</option><option value="Not Supportive">Not Supportive</option></select></div>

                <div class="loading" id="loadingMessage"><p>Submitting your entire application... Please wait.</p></div>
                <button type="submit" class="btn-submit" id="submitBtn">Submit Final Application</button>
            </form>
        </div>

        <div id="section-thankyou" class="form-section">
            <div class="success-icon">âœ“</div>
            <h2>Application Received!</h2>
            <p style="margin-bottom: 20px; color: #555;">Your application and assessment have been successfully submitted.</p>
            
            <div id="finalSummary" style="background: #f8f9fa; padding: 20px; border-radius: 10px; text-align: left; border-left: 4px solid #27ae60;"></div>
            
            <p style="margin-top: 25px; font-weight: bold;">Please save your Application ID for your records.</p>
            <button onclick="location.reload()" class="btn-submit" style="background: #f39c12; margin-top: 20px;">Return to Start</button>
        </div>
    </div>

    <script>
        // SCRIPT URL PROVIDED
        const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycby3YGmXDT1QukI0QrVhpkYieXbmzbvHlu0tc4jy-kS2tWydLSxUbUyi63j-VinjOtf5Sg/exec';
        
        // PROGRAM INFO
        const PROGRAM_DETAILS = {
            "Artisan Baking": { name: "Artisan Baking School", image: "https://sozo.org.za/wp-content/uploads/2024/03/Skills-Training-Programme-at-Sozo-Foundation.webp", description: "Hands-on training in techniques, cake decoration, and confectionery production." },
            "Barista": { name: "Barista School", image: "https://sozo.org.za/wp-content/uploads/2024/02/Sozo-Website-Portrait-Photos-800-x-900-px.webp", description: "Learn the intricacies of brewing, roasting beans, and latte art." },
            "Hair": { name: "Hairdressing School", image: "https://sozo.org.za/wp-content/uploads/2024/02/Sozo-Foundation-Skills-Training-Programmes-3.webp", description: "Expertise in washing, blow-drying, colouring, and cutting." },
            "Beauty": { name: "Beauty School", image: "https://sozo.org.za/wp-content/uploads/2024/02/Sozo-Foundation-Skills-Training-Programmes-4.webp", description: "Training in skincare, make-up artistry, and nail technology." }
        };

        // GLOBAL DATA STORAGE
        let completeApplicationData = {};

        // === IDENTIFICATION & LOGIC FUNCTIONS ===
        function getCentury(yearString) { return parseInt(yearString) > (new Date().getFullYear() % 100) ? 1900 + parseInt(yearString) : 2000 + parseInt(yearString); }
        function calculateAge(dob) { const today = new Date(); const birthDate = new Date(dob); let age = today.getFullYear() - birthDate.getFullYear(); const m = today.getMonth() - birthDate.getMonth(); if (m < 0 || (m === 0 && today.getDate() < birthDate.getDate())) age--; return age; }
        
        function processSAID(input) {
            const idNumber = input.value.trim();
            const dobInput = document.getElementById('dateOfBirthInput');
            const ageInput = document.getElementById('ageInput');
            const genderSelect = document.querySelector('[name="gender"]');
            dobInput.value = ''; ageInput.value = ''; genderSelect.value = ''; toggleConstructionExperience(genderSelect);
            if (idNumber.length === 13 && /^\d{13}$/.test(idNumber)) {
                const year = idNumber.substring(0, 2); const month = idNumber.substring(2, 4); const day = idNumber.substring(4, 6);
                const fullYear = getCentury(year); const dobString = `${fullYear}-${month}-${day}`; const dateCheck = new Date(dobString);
                if (dateCheck.getFullYear() === fullYear && dateCheck.getMonth() === parseInt(month) - 1) {
                    const age = calculateAge(dobString);
                    if (age >= 16 && age <= 65) {
                        dobInput.value = dobString; ageInput.value = age;
                        genderSelect.value = parseInt(idNumber.substring(10, 11)) >= 5 ? 'Male' : 'Female';
                        toggleConstructionExperience(genderSelect);
                    } else alert(`ID valid, but age (${age}) is outside required range (16-65).`);
                }
            }
        }

        function toggleIdentificationType(radio) {
            const isSAID = radio.value === 'SA ID';
            document.getElementById('saIdGroup').style.display = isSAID ? 'block' : 'none';
            document.getElementById('passportGroup').style.display = isSAID ? 'none' : 'block';
            document.getElementById('idNumberInput').required = isSAID;
            document.getElementById('passportNumberInput').required = !isSAID;
            document.getElementById('permitStatusInput').required = !isSAID;
            document.getElementById('dateOfBirthInput').readOnly = isSAID;
            document.getElementById('ageInput').readOnly = isSAID;
            document.getElementById('dateOfBirthInput').style.backgroundColor = isSAID ? '#eee' : 'white';
            document.getElementById('ageInput').style.backgroundColor = isSAID ? '#eee' : 'white';
            if(!isSAID) { document.getElementById('idNumberInput').value = ''; document.getElementById('dateOfBirthInput').value = ''; document.getElementById('ageInput').value = ''; }
            else { document.getElementById('passportNumberInput').value = ''; document.getElementById('permitStatusInput').value = ''; togglePermitDetails(document.getElementById('permitStatusInput')); }
        }
        function togglePermitDetails(select) {
            const group = document.getElementById('permitDetailsGroup');
            group.style.display = select.value === 'Yes' ? 'block' : 'none';
            group.querySelector('input').required = select.value === 'Yes';
            if (select.value !== 'Yes') group.querySelector('input').value = '';
        }
        function toggleDisabilityType(select) { document.getElementById('disabilityTypeGroup').style.display = select.value === 'Yes' ? 'block' : 'none'; if (select.value !== 'Yes') document.querySelector('[name="disabilityType"]').value = ''; }
        function toggleConstructionExperience(select) { 
            const isMale = select.value === 'Male';
            document.getElementById('constructionExperienceSection').style.display = isMale ? 'block' : 'none';
            if (!isMale) { document.querySelector('[name="constructionExperience"]').value = 'No'; toggleConstructionDetails(document.querySelector('[name="constructionExperience"]')); }
        }
        function toggleConstructionDetails(select) { document.getElementById('constructionDetailsGroup').style.display = select.value === 'Yes' ? 'block' : 'none'; if (select.value !== 'Yes') document.querySelector('[name="constructionDetails"]').value = ''; }
        function displayProgramInfo(select) {
            const infoBox = document.getElementById('programInfoBox');
            if (select.value && PROGRAM_DETAILS[select.value]) {
                const p = PROGRAM_DETAILS[select.value];
                infoBox.innerHTML = `<h3>${p.name}</h3><img src="${p.image}" alt="${p.name}"><p>${p.description}</p>`;
                infoBox.style.display = 'block';
            } else { infoBox.style.display = 'none'; }
        }

        // === NAVIGATION & SUBMISSION ===
        function switchSection(fromId, toId, title, subtitle) {
            document.getElementById(fromId).classList.remove('active');
            document.getElementById(toId).classList.add('active');
            window.scrollTo(0,0);
            if (title) document.getElementById('pageTitle').innerText = title;
            if (subtitle) document.getElementById('pageSubtitle').innerText = subtitle;
        }

        function goToAssessment() {
            const form = document.getElementById('appForm');
            if (!form.checkValidity()) { form.reportValidity(); return; }

            // Harvest Application Data
            const formData = new FormData(form);
            formData.forEach((value, key) => { completeApplicationData[key] = value; });

            // Clean conditional fields
            if (completeApplicationData.identificationType === 'SA ID') { delete completeApplicationData.passportNumber; delete completeApplicationData.permitStatus; delete completeApplicationData.permitDetails; }
            else { delete completeApplicationData.idNumber; if (completeApplicationData.permitStatus === 'No') completeApplicationData.permitDetails = 'No permit held'; }
            if (completeApplicationData.gender !== 'Male') { completeApplicationData.constructionExperience = 'N/A'; completeApplicationData.constructionDetails = 'N/A'; }
            else if (completeApplicationData.constructionExperience === 'No') completeApplicationData.constructionDetails = 'None described';

            // Switch UI
            switchSection('section-application', 'section-assessment', 'ðŸ“ Assessment', 'Step 2: Skills & Motivation');
        }

        document.getElementById('assessmentForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            const submitBtn = document.getElementById('submitBtn');
            const loadingMessage = document.getElementById('loadingMessage');
            submitBtn.disabled = true; loadingMessage.style.display = 'block';

            // Harvest Assessment Data
            const formData = new FormData(this);
            let scoreSum = 0, scoreCount = 0;
            
            formData.forEach((value, key) => { 
                completeApplicationData[key] = value;
                // Calculate score
                if (['technicalKnowledge', 'followInstructions', 'timeManagement', 'teamwork', 'customerCommunication', 'askingHelp', 'socialMedia', 'employmentImportance', 'commitment'].includes(key)) {
                    const score = parseInt(value); if (!isNaN(score)) { scoreSum += score; scoreCount++; }
                }
            });

            // Finalize Data Packet
            completeApplicationData.id = 'SS-' + Date.now().toString().slice(-8); // Generate ID
            completeApplicationData.submissionDate = new Date().toLocaleString();
            completeApplicationData.applicationStatus = 'Assessment Completed';
            completeApplicationData.assessmentCompleted = 'YES';
            completeApplicationData.baselineScore = scoreCount > 0 ? (scoreSum / scoreCount).toFixed(2) : 'N/A';
            completeApplicationData.type = 'full_submission'; // Tag for script

            try {
                const response = await fetch(SCRIPT_URL, { 
                    method: 'POST', 
                    body: JSON.stringify(completeApplicationData), 
                    headers: { 'Content-Type': 'text/plain;charset=utf-8' } // Fix CORS error
                });
                
                const result = await response.json();
                if (result.status === 'success') {
                    // Show Thank You
                    loadingMessage.style.display = 'none';
                    switchSection('section-assessment', 'section-thankyou', 'Application Sent', 'Thank You');
                    
                    // Display Summary
                    const summary = document.getElementById('finalSummary');
                    summary.innerHTML = `
                        <div class="info-item"><span class="info-label">Application ID:</span><span class="info-value"><strong>${completeApplicationData.id}</strong></span></div>
                        <div class="info-item"><span class="info-label">Name:</span><span class="info-value">${completeApplicationData.firstName} ${completeApplicationData.lastName}</span></div>
                        <div class="info-item"><span class="info-label">Program:</span><span class="info-value">${completeApplicationData.program}</span></div>
                        <div class="info-item"><span class="info-label">Baseline Score:</span><span class="info-value">${completeApplicationData.baselineScore} / 5.0</span></div>
                    `;
                } else throw new Error(result.message);
            } catch (error) {
                console.error(error); 
                alert('Submission error: ' + error.message + '. Please check your connection.');
                submitBtn.disabled = false; loadingMessage.style.display = 'none';
            }
        });
    </script>
</body>
</html>